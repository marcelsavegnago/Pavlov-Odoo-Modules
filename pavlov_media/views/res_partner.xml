<odoo>

  <!-- Inherit main res_partner form -->
  <record id="pavlov_media_customizations_inherit_view_form" model="ir.ui.view">
    <field name="model">res.partner</field>
    <field name="inherit_id" ref="base.view_partner_form"/>
    <field name="arch" type="xml">
      <data>
        <!-- Show the helpdesk ticket smart button if count is 0 -->
        <button name="action_open_helpdesk_ticket" position="attributes">
            <attribute name="attrs"/>
        </button>

        <!-- Add Service Location, Unit and Room to contact form -->
        <xpath expr="//field[@name='type']" position="after">
          <field name="service_location_id"
                 placeholder="Service Location..."
                 string="Service Location"
                 attrs="{'invisible':[('company_type','=','company')], 'required': [('category_id','=', 'Resident')]}"
                 domain="[('category_id','like','Service Location')]"
                 options="{'no_create': True, 'no_open': True}"/>
          <field name="service_location_unit_id"
                 placeholder="Unit..."
                 class="o_address_street"
                 attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)],
                         'invisible':[('company_type','=','company')],
                         'required':[('category_id','=','Resident')]}"
                 domain="[('fsm_parent_id', '=', service_location_id),('category_id','not like','Service Location')]"
                 options="{'no_create': True, 'no_open': True}"/>
          <field name="room"
                 placeholder="Room..."
                 attrs="{'invisible':[('company_type','=','company')]}"/>
          <field name="spacer"/>
        </xpath>

        <!-- Require Phone Number -->
        <field name="phone" position="replace">
           <field name="phone"
                  widget="phone"
                  attrs="{'required': [('company_type','=','person')]}"/>
        </field>

        <!-- Require Email -->
        <field name="email" position="replace">
           <field name="email"
                  widget="email"
                  context="{'gravatar_image': True}"
                  attrs="{'required': ['|',('user_ids','!=', []),('company_type','=','person')]}"/>
        </field>

        <!-- Require Tag -->
        <field name="category_id" position="attributes">
           <attribute name="required">True</attribute>
        </field>

        <!-- Move tags above address info -->
        <field name="type" position="before">
            <field name="category_id" position="move"/>
        </field>

        <!-- Move job position below title -->
        <field name="title" position="before">
            <field name="function" position="move"/>
        </field>

        <!-- Move tax id into sales section -->
        <field name="ref" position="after">
            <field name="vat" position="move"/>
        </field>
      </data>
    </field>
  </record>

  <!-- Inherit Field Service Form -->
  <record id="pavlov_media_customizations_inherit_field_service_view_form" model="ir.ui.view">
    <field name="model">res.partner</field>
    <field name="inherit_id" ref="fieldservice.fsm_partner_fields"/>
    <field name="arch" type="xml">
      <data>
        <!-- remove service location field since it was added above -->
        <xpath expr="//field[@name='service_location_id']" position="replace">
        </xpath>
      </data>
    </field>
  </record>

</odoo>
