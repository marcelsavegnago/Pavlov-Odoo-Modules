<!-- Copyright (C) 2019 Pavlov Media
    License Proprietary. Do not copy, share nor distribute.-->

<odoo>
    <!-- Form View -->
    <record id="project_task_timer_form_inherit_view" model="ir.ui.view">
        <field name="name">project.task.timer.form</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_form2"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='kanban_state']" position="replace">
                <field name="timer_ids" invisible="1"/>
                <field name="timer_started" invisible="1"/>
                <div class="oe_right">
                    <field name="kanban_state" widget="state_selection"/>
                    <button name="task_start_timer"
                            type="object"
                            attrs="{'invisible': ['|',('timer_started', '=', True),('project_id', '=', False)]}"
                            icon="/project_task_timer/static/buttons/start_timer_icon.png"/>
                    <button name="task_start_timer"
                            type="object"
                            attrs="{'invisible': ['|',('timer_started', '=', False),('project_id', '=', False)]}"
                            icon="/project_task_timer/static/buttons/start_multiple_timer_icon.png"/>
                    <button name="task_end_timer"
                            type="object"
                            attrs="{'invisible': ['|',('timer_ids', '=', [])]}"
                            icon="/project_task_timer/static/buttons/stop_timer_icon.png"/>
                </div>
            </xpath>
        </field>
    </record>

    <!-- Kanban View -->
    <record id="project_task_timer_kanban_inherit_view" model="ir.ui.view">
        <field name="name">project.task.timer.kanban</field>
        <field name="model">project.task</field>
        <field name="inherit_id" ref="project.view_task_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@class='oe_kanban_bottom_left']" position="inside">
                <field name="timer_started" invisible="1"/>
                <div>
                    <t t-if="record.timer_started.raw_value == true">
                        <img src="/project_task_timer/static/buttons/start_multiple_timer_icon.png" width="26" height="18"/>
                    </t>
                </div>
            </xpath>
        </field>
    </record>
</odoo>
